title: FIN7 - Process Chain
id: b92d1d19-f5c9-4ed6-bbd5-7476709dc389
status: experimental
description: |
    Detects suspicious process chain of cmd or powerhell being spawned from notepad++
references:
    - https://cloud.google.com/blog/topics/threat-intelligence/evolution-of-fin7/
author: Alex Walston (@4ayymm)
date: 2024/07/24
tags:
    - attack.command_and_scripting_interpreter
    - attack.t1059.003
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        ParentImage|endswith: '\notepad++.exe'
    selection_child:
        - Image|endswith:
              - '\cmd.exe'
              - '\powershell.exe'
    condition: selection and selection_child
falsepositives:
    - Unknown
level: medium
